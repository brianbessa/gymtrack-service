{% load static %}
<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>GymTrack</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/home.css' %}">
</head>

<body>
    <section class="banner" id="home">
        <div class="overlay">
            <header class="topo">
                <img src="{% static 'img/logo_home.png' %}" alt="Logo GymTrack" class="logo">
                <nav>
                    <a href="#home">HOME</a>
                    <a href="#calculadoras">CALCULADORAS E TABELA NUTRICIONAL</a>
                    <a href="#sobre">SOBRE</a>
                    <a href="#servicos">SERVI√áOS</a>
                </nav>
                <div class="acesso">
                    <a href="#" class="btn">
                        Suporte
                    </a>
                    <a href="{% url 'login' %}" class='btn'>
                        <b>Cadastre-se </b>ou<br>
                        <b>fa√ßa seu login</b>
                    </a>
                </div>
            </header>
            <div class="conteudo-banner">
                <div class="texto-banner">
                    <h1>MAIS <span style="color: #3494e6; font-weight: 700;">CONTROLE</span>. MAIS <span style="color: #3494e6; font-weight: 700;">PROGRESSO</span>.</h1>
                    <p>A <span style="font-weight: 700;">GYMTRACK</span> foca no acompanhamento inteligente dos treinos para maximizar sua evolu√ß√£o</p>
                    <a href="{% url 'notificacao' %}" class="botao">EXPLORE MAIS</a>
                </div>
                <div class="imagem-banner">
              
                </div>
            </div>
        </div>
    </section>

    <main class="container" id="calculadoras">
    <section class="card" style="background-color: #f2f2f2;">
      <h2><img src="{% static 'img/medidor.png' %}" alt="√çcone" class="icon" style="width: 65px;"> Calcular IMC e TMB</h2>
      <div class="row">
        <input id="altura" placeholder="Altura (ex.: 170)" />
        <input id="peso" placeholder="Peso (ex.: 64.5)" style="width: 20px;"/>
      </div>
      <div class="row">
        <input id="idade" placeholder="Idade (ex.: 21)" />
        <select id="sexo">
          <option value="">Sexo</option>
          <option value="masculino">Masculino</option>
          <option value="feminino">Feminino</option>
        </select>
      </div>
      <div class="atividade">
        <label><input type="radio" name="atividade" value="1.2" checked> Sedent√°rio</label>
        <label><input type="radio" name="atividade" value="1.375"> Levemente ativo</label>
        <label><input type="radio" name="atividade" value="1.55"> Moderadamente ativo</label>
        <label><input type="radio" name="atividade" value="1.725"> Muito ativo</label>
        <label><input type="radio" name="atividade" value="1.9"> Extremamente ativo</label>
      </div>
      <button onclick="calcularIMCeTMB()" style="width: 100%">Calcular</button>

      <table>
        <thead>
          <tr><th>IMC</th><th>CLASSIFICA√á√ÉO</th><th>OBESIDADE (GRAU)</th></tr>
        </thead>
        <tbody>
          <tr><td>MENOR QUE 18,5</td><td>MAGREZA</td><td>0</td></tr>
          <tr><td>ENTRE 18,5 E 24,9</td><td>NORMAL</td><td>0</td></tr>
          <tr><td>ENTRE 25,0 E 29,9</td><td>SOBREPESO</td><td>I</td></tr>
          <tr><td>ENTRE 30,0 E 39,9</td><td>OBESIDADE</td><td>II</td></tr>
          <tr><td>MAIOR QUE 40,0</td><td>OBESIDADE GRAVE</td><td>III</td></tr>
        </tbody>
      </table>
    </section>

    <section class="card" style="background-color: #f2f2f2;">
      <h2>
        <img src="{% static 'img/alimento.png' %}" alt="√çcone" class="icon">
        Calcular Ingest√£o de Alimentos
      </h2>

      <div class="alimento-wrapper">
        <label for="alimento">Alimento</label>
        <input id="alimento" placeholder="Informe o alimento desejado" />
      </div>

      <div class="quantidade-wrapper">
        <label for="quantidade">Quantidade</label>
        <input id="quantidade" type="number" placeholder="Quantidade" value="1" />
        <button onclick="buscarAlimento()">Buscar</button>
      </div>

      <table id="tabelaAlimento">
        <thead><tr><th colspan="2">Tabela nutricional</th></tr></thead>
        <tbody></tbody>
      </table>
    </section>

  </main>

    <section class="sobre" id="sobre">
        <img src="{% static 'img/sobre.png' %}" alt="Sobre a GymTrack">
        <div class="texto">
            <h2>SOBRE N√ìS</h2>
            <h3>GYMTRACK</h3>
            <p>A GymTrack √© uma plataforma inteligente que une tecnologia e ci√™ncia do treino para potencializar
                resultados na academia. Com planos personalizados, acompanhamento de carga, gr√°ficos din√¢micos e suporte
                de especialistas como nutricionistas,
                n√≥s oferecemos uma experi√™ncia completa para quem leva seus objetivos a s√©rio. Tudo isso em um s√≥ lugar
                ‚Äî simples, eficiente e feito sob medida para sua evolu√ß√£o.</p>
        </div>
    </section>

    <section class="plano" id="servicos">
    <div class="destaque">
        <h2>PLANO PLUS</h2>
        <p>Invista no seu futuro hoje. Assine o plano que transforma esfor√ßo em resultados!</p>
        <h3>R$ 49,90/m√™s</h3>
        <a href="{% url 'cadastro' %}">CONTRATAR PLANO</a>
    </div>

    <span class="seta-baixo"> </span>

    <div class="beneficios">
        <h3>OS BENEF√çCIOS</h3>
        <ul>
            <li>
                <img src="{% static 'img/icon_carga.png' %}" alt="Acompanhamento">
                <strong>ACOMPANHAMENTO DE CARGA</strong>
                <span>Track inteligente da sua progress√£o com dados precisos de volume e intensidade.</span>
            </li>
            <li>
                <img src="{% static 'img/icon_graficos.png' %}" alt="Gr√°ficos">
                <strong>GR√ÅFICOS DIN√ÇMICOS</strong>
                <span>Visualize seu desempenho em tempo real com gr√°ficos que mostram sua evolu√ß√£o muscular.</span>
            </li>
            <li>
                <img src="{% static 'img/icon_plano.png' %}" alt="Plano">
                <strong>PLANO PERSONALIZADO</strong>
                <span>Algoritmos avan√ßados para montar o treino ideal, adaptado aos seus objetivos.</span>
            </li>
            <li>
                <img src="{% static 'img/icon_nutri.png' %}" alt="Nutricionista">
                <strong>ACOMPANHAMENTO COM NUTRICIONISTA</strong>
                <span>Conecte-se com especialistas e alinhe sua alimenta√ß√£o aos objetivos com precis√£o cient√≠fica.</span>
            </li>
        </ul>
    </div>

    <div class="rodape-cta">
        <p>Seja parte da transforma√ß√£o. Cadastre-se como nutricionista e leve seu conhecimento a quem busca resultado de verdade!</p>
        <a href="{% url 'cadastro-nutricionista' %}">CADASTRE-SE PARA TRABALHAR CONOSCO</a>
    </div>
    </section>

    <script>
        function calcularIMCeTMB() {
        const altura = parseFloat(document.getElementById('altura').value);
        const peso = parseFloat(document.getElementById('peso').value);
        const idade = parseInt(document.getElementById('idade').value);
        const sexo = document.getElementById('sexo').value;
        const atividade = parseFloat(document.querySelector('input[name="atividade"]:checked').value);

        if (!altura || !peso || !idade || !sexo) {
        alert("Preencha todos os campos!");
        return;
        }

        const alturaM = altura / 100;
        const imc = peso / (alturaM * alturaM);

        let tmb;
        if (sexo === "masculino") {
        tmb = 88.36 + (13.397 * peso) + (4.799 * altura) - (5.677 * idade);
        } else {
        tmb = 447.6 + (9.2 * peso) + (3.1 * altura) - (4.3 * idade);
        }

        const tmbTotal = tmb * atividade;

        let classificacao = "";
        if (imc < 18.5) classificacao = "Magreza (Grau 0)";
        else if (imc < 25) classificacao = "Normal (Grau 0)";
        else if (imc < 30) classificacao = "Sobrepeso (Grau I)";
        else if (imc < 40) classificacao = "Obesidade (Grau II)";
        else classificacao = "Obesidade Grave (Grau III)";

        const conteudo = `
          <strong>Resultado:</strong><br>
          ‚úÖ <b>IMC:</b> ${imc.toFixed(2)} ${classificacao}<br>
          üî• <b>TMB:</b> ${tmb.toFixed(2)} kcal/dia<br>
          üèÉ‚Äç‚ôÇÔ∏è <b>Gasto Di√°rio com Atividade:</b> ${tmbTotal.toFixed(2)} kcal/dia
        `;

        document.getElementById('conteudoModal').innerHTML = conteudo;
        document.getElementById('modalResultado').style.display = 'block';
    }

    async function buscarAlimento() {
      const nome = document.getElementById('alimento').value;
      const quantidade = parseFloat(document.getElementById('quantidade').value) || 1;
      const tabela = document.getElementById('tabelaAlimento').querySelector("tbody");

      if (!nome) return alert("Digite um alimento!");

      tabela.innerHTML = "<tr><td colspan='2'>Buscando...</td></tr>";

      try {
        const res = await fetch(`/api/buscar-alimento/?nome=${nome}&quantidade=${quantidade}`);
        const data = await res.json();
        const alimento = data.items?.[0];

        if (!alimento) {
          tabela.innerHTML = "<tr><td colspan='2'>Alimento n√£o encontrado</td></tr>";
          return;
        }

        tabela.innerHTML = `
          <tr><td>Calorias</td><td>${alimento.calories.toFixed(2)} kcal</td></tr>
          <tr><td>Carboidratos</td><td>${alimento.carbohydrates_total_g.toFixed(2)} g</td></tr>
          <tr><td>Prote√≠nas</td><td>${alimento.protein_g.toFixed(2)} g</td></tr>
          <tr><td>Gorduras totais</td><td>${alimento.fat_total_g.toFixed(2)} g</td></tr>
          <tr><td>Gorduras saturadas</td><td>${alimento.fat_saturated_g.toFixed(2)} g</td></tr>
        `;
      } catch (err) {
        tabela.innerHTML = "<tr><td colspan='2'>Erro na busca</td></tr>";
        console.error(err);
      }
    }

    function fecharModal() {
      document.getElementById('modalResultado').style.display = 'none';
    }

    </script>

    <div id="modalResultado" class="modal">
      <div class="modal-conteudo">
        <span class="fechar" onclick="fecharModal()">&times;</span>
        <div id="conteudoModal"></div>
      </div>
    </div>
</body>

</html>